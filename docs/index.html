<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@samouraiwallet/bip47</title><meta name="description" content="Documentation for @samouraiwallet/bip47"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@samouraiwallet/bip47</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>@samouraiwallet/bip47</h2></div><div class="tsd-panel tsd-typography"><a id="md:samouraiwalletbip47" class="tsd-anchor"></a><h1><a href="#md:samouraiwalletbip47">@samouraiwallet/bip47</a></h1><p>A set of utilities for working with BIP47 and bitcoinjs-lib.</p>
<p>This library uses ES Modules. Node.js v16 or later is required.
This library does not use any Node.js built-ins and thus is browser compatible.</p>
<p>Source code was written in Typescript. Type definitions are included in the published bundle.</p>
<a id="md:contents" class="tsd-anchor"></a><h2><a href="#md:contents">Contents</a></h2><ul>
<li><a href="#md:installation">Installation</a></li>
<li><a href="#md:api-documentation">API documentation</a></li>
<li>Usage<ul>
<li><a href="#md:ecc-library">ECC library</a></li>
<li><a href="#md:examples">Examples</a></li>
<li><a href="#md:interfaces">Interfaces</a></li>
</ul>
</li>
</ul>
<a id="md:installation" class="tsd-anchor"></a><h2><a href="#md:installation">Installation</a></h2><pre><code class="language-bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@samouraiwallet/bip47</span>
</code><button>Copy</button></pre>
<p>or</p>
<pre><code class="language-bash"><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">@samouraiwallet/bip47</span>
</code><button>Copy</button></pre>
<p>or</p>
<pre><code class="language-bash"><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">@samouraiwallet/bip47</span>
</code><button>Copy</button></pre>
<a id="md:api-documentation" class="tsd-anchor"></a><h2><a href="#md:api-documentation">API documentation</a></h2><p>Generated API documentation is available in the git repository. To view latest API docs locally, you can run these commands.</p>
<pre><code class="language-bash"><span class="hl-3"># create a temp folder</span><br/><span class="hl-0">mkdir</span><span class="hl-1"> </span><span class="hl-2">bip47-docs</span><br/><span class="hl-0">cd</span><span class="hl-1"> </span><span class="hl-2">bip47-docs</span><br/><br/><span class="hl-3"># download and extract docs directory</span><br/><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-4">-fsSL</span><span class="hl-1"> </span><span class="hl-2">https://code.samourai.io/dojo/bip47-js/-/archive/master/bip47-js-master.tar.gz</span><span class="hl-5">\?</span><span class="hl-2">path</span><span class="hl-5">\=</span><span class="hl-2">docs</span><span class="hl-1"> | </span><span class="hl-0">tar</span><span class="hl-1"> </span><span class="hl-4">-xzv</span><span class="hl-1"> </span><span class="hl-4">--strip-components=2</span><br/><br/><span class="hl-3"># run simple HTTP file server</span><br/><span class="hl-0">npx</span><span class="hl-1"> </span><span class="hl-2">serve</span><span class="hl-1"> </span><span class="hl-2">.</span>
</code><button>Copy</button></pre>
<a id="md:usage" class="tsd-anchor"></a><h2><a href="#md:usage">Usage</a></h2><a id="md:ecc-library" class="tsd-anchor"></a><h3><a href="#md:ecc-library">ECC library</a></h3><p>You need to provide an implementation of <code>secp256k1</code> elliptic curve.</p>
<p>Supported libraries:</p>
<ul>
<li><a href="https://github.com/bitcoinjs/tiny-secp256k1">tiny-secp256k1</a> - Rust implementation compiled to Webassembly, work in Node.js and browsers but might require reconfiguring your bundler</li>
<li><a href="https://github.com/bitcoinerlab/secp256k1">@bitcoinerlab/secp256k1</a> - Javascript implementation which works everywhere but has a lower performance</li>
</ul>
<a id="md:examples" class="tsd-anchor"></a><h3><a href="#md:examples">Examples</a></h3><ul>
<li><a href="#md:create-an-instance-of-bip47">Create an instance of bip47</a></li>
<li><a href="#md:create-a-paymetcodeprivate-instance-from-wallet-master-seed">Create a PaymetCodePrivate instance from wallet master seed</a></li>
<li><a href="#md:create-a-paymetcodepublic-instance-from-payment-code-string">Create a PaymetCodePublic instance from payment code string</a></li>
<li><a href="#md:generate-a-base58-encoded-payment-code">Generate a base58 encoded payment code</a></li>
<li><a href="#md:get-notification-address">Get notification address</a></li>
<li><a href="#md:get-notification-address-public-key">Get notification address public key</a></li>
<li><a href="#md:get-notification-address-private-key">Get notification address private key</a></li>
<li><a href="#md:derive-addresses-from-alice-to-bob">Derive addresses from Alice to Bob</a></li>
<li><a href="#md:derive-payment-keys-from-alice-to-bob">Derive payment keys from Alice to Bob</a></li>
<li><a href="#md:extract-payment-code-from-notification-transaction">Extract payment code from notification transaction</a></li>
<li><a href="#md:get-blinded-payment-code-for-notification-transaction">Get blinded payment code for notification transaction</a></li>
</ul>
<a id="md:create-an-instance-of-bip47" class="tsd-anchor"></a><h4><a href="#md:create-an-instance-of-bip47">Create an instance of bip47</a></h4><pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-7">BIP47Factory</span><span class="hl-1"> </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@samouraiwallet/bip47&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-4">*</span><span class="hl-1"> </span><span class="hl-6">as</span><span class="hl-1"> </span><span class="hl-7">ecc</span><span class="hl-1"> </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;tiny-secp256k1&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bip47</span><span class="hl-1"> = </span><span class="hl-0">BIP47Factory</span><span class="hl-1">(</span><span class="hl-7">ecc</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<a id="md:create-a-paymetcodeprivate-instance-from-wallet-master-seed" class="tsd-anchor"></a><h4><a href="#md:create-a-paymetcodeprivate-instance-from-wallet-master-seed">Create a PaymetCodePrivate instance from wallet master seed</a></h4><p><strong>on mainnet</strong></p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-6">type</span><span class="hl-1"> {</span><span class="hl-7">PaymentCodePrivate</span><span class="hl-1">} </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@samouraiwallet/bip47&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">walletSeed</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">alice</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1"> = </span><span class="hl-7">bip47</span><span class="hl-1">.</span><span class="hl-0">fromSeed</span><span class="hl-1">(</span><span class="hl-7">walletSeed</span><span class="hl-1">);</span><br/><br/><span class="hl-3">// with segwit support</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">alice2</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1"> = </span><span class="hl-7">bip47</span><span class="hl-1">.</span><span class="hl-0">fromSeed</span><span class="hl-1">(</span><span class="hl-7">walletSeed</span><span class="hl-1">, </span><span class="hl-4">true</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<p><strong>on testnet</strong></p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-6">type</span><span class="hl-1"> {</span><span class="hl-7">PaymentCodePrivate</span><span class="hl-1">} </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@samouraiwallet/bip47&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> {</span><span class="hl-7">networks</span><span class="hl-1">} </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@samouraiwallet/bip47/utils&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">walletSeed</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-3">// pass in a desired network object (bitcoin | testnet | regtest) from utils or directly from bitcoinjs-lib</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">alice</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1"> = </span><span class="hl-7">bip47</span><span class="hl-1">.</span><span class="hl-0">fromSeed</span><span class="hl-1">(</span><span class="hl-7">walletSeed</span><span class="hl-1">, </span><span class="hl-4">false</span><span class="hl-1">, </span><span class="hl-7">networks</span><span class="hl-1">[</span><span class="hl-2">&#39;testnet&#39;</span><span class="hl-1">]);</span><br/><span class="hl-3">// with segwit support</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">alice2</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1"> = </span><span class="hl-7">bip47</span><span class="hl-1">.</span><span class="hl-0">fromSeed</span><span class="hl-1">(</span><span class="hl-7">walletSeed</span><span class="hl-1">, </span><span class="hl-4">true</span><span class="hl-1">, </span><span class="hl-7">networks</span><span class="hl-1">[</span><span class="hl-2">&#39;testnet&#39;</span><span class="hl-1">]);</span>
</code><button>Copy</button></pre>
<a id="md:create-a-paymetcodepublic-instance-from-payment-code-string" class="tsd-anchor"></a><h4><a href="#md:create-a-paymetcodepublic-instance-from-payment-code-string">Create a PaymetCodePublic instance from payment code string</a></h4><p><strong>on mainnet</strong></p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-6">type</span><span class="hl-1"> {</span><span class="hl-7">PaymentCodePublic</span><span class="hl-1">} </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@samouraiwallet/bip47&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">pcode</span><span class="hl-1"> = </span><span class="hl-2">&quot;PM8TJS2JxQ5ztXUpBBRnpTbcUXbUHy2T1abfrb3KkAAtMEGNbey4oumH7Hc578WgQJhPjBxteQ5GHHToTYHE3A1w6p7tU6KSoFmWBVbFGjKPisZDbP97&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bob</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1"> = </span><span class="hl-7">bip47</span><span class="hl-1">.</span><span class="hl-0">fromBase58</span><span class="hl-1">(</span><span class="hl-7">pcode</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<p><strong>on testnet</strong></p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-6">type</span><span class="hl-1"> {</span><span class="hl-7">PaymentCodePublic</span><span class="hl-1">} </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@samouraiwallet/bip47&quot;</span><span class="hl-1">;</span><br/><span class="hl-6">import</span><span class="hl-1"> {</span><span class="hl-7">networks</span><span class="hl-1">} </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@samouraiwallet/bip47/utils&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">pcode</span><span class="hl-1"> = </span><span class="hl-2">&quot;PM8TJS2JxQ5ztXUpBBRnpTbcUXbUHy2T1abfrb3KkAAtMEGNbey4oumH7Hc578WgQJhPjBxteQ5GHHToTYHE3A1w6p7tU6KSoFmWBVbFGjKPisZDbP97&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">// pass in a desired network object (bitcoin | testnet | regtest) from utils or directly from bitcoinjs-lib</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bob</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1"> = </span><span class="hl-7">bip47</span><span class="hl-1">.</span><span class="hl-0">fromBase58</span><span class="hl-1">(</span><span class="hl-7">pcode</span><span class="hl-1">, </span><span class="hl-7">networks</span><span class="hl-1">[</span><span class="hl-2">&#39;testnet&#39;</span><span class="hl-1">]);</span>
</code><button>Copy</button></pre>
<a id="md:generate-a-base58-encoded-payment-code" class="tsd-anchor"></a><h4><a href="#md:generate-a-base58-encoded-payment-code">Generate a base58 encoded payment code</a></h4><pre><code class="language-ts"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">alicePcode</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> = </span><span class="hl-7">alice</span><span class="hl-1">.</span><span class="hl-0">toBase58</span><span class="hl-1">(); </span><span class="hl-3">// PM8TJTLJbPRGxSbc8EJi42Wrr6QbNSaSSVJ5Y3E4pbCYiTHUskHg13935Ubb7q8tx9GVbh2UuRnBc3WSyJHhUrw8KhprKnn9eDznYGieTzFcwQRya4GA</span>
</code><button>Copy</button></pre>
<a id="md:get-notification-address" class="tsd-anchor"></a><h4><a href="#md:get-notification-address">Get notification address</a></h4><pre><code class="language-ts"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">aliceNotificationAddress</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> = </span><span class="hl-7">alice</span><span class="hl-1">.</span><span class="hl-0">getNotificationAddress</span><span class="hl-1">(); </span><span class="hl-3">// 1JDdmqFLhpzcUwPeinhJbUPw4Co3aWLyzW</span>
</code><button>Copy</button></pre>
<a id="md:get-notification-address-public-key" class="tsd-anchor"></a><h4><a href="#md:get-notification-address-public-key">Get notification address public key</a></h4><pre><code class="language-ts"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">aliceNotifPubKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1"> = </span><span class="hl-7">alice</span><span class="hl-1">.</span><span class="hl-0">getNotificationPublicKey</span><span class="hl-1">(); </span><span class="hl-3">// 0353883a146a23f988e0f381a9507cbdb3e3130cd81b3ce26daf2af088724ce683 </span>
</code><button>Copy</button></pre>
<a id="md:get-notification-address-private-key" class="tsd-anchor"></a><h4><a href="#md:get-notification-address-private-key">Get notification address private key</a></h4><pre><code class="language-ts"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">aliceNotifPrivKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1"> = </span><span class="hl-7">alice</span><span class="hl-1">.</span><span class="hl-0">getNotificationPrivateKey</span><span class="hl-1">(); </span><span class="hl-3">// 8d6a8ecd8ee5e0042ad0cb56e3a971c760b5145c3917a8e7beaf0ed92d7a520c </span>
</code><button>Copy</button></pre>
<a id="md:derive-addresses-from-alice-to-bob" class="tsd-anchor"></a><h4><a href="#md:derive-addresses-from-alice-to-bob">Derive addresses from Alice to Bob</a></h4><p><strong>Alice&#39;s side</strong></p>
<pre><code class="language-ts"><span class="hl-3">// Bob&#39;s P2PKH address at index 0</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bobAddress</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> = </span><span class="hl-7">bob</span><span class="hl-1">.</span><span class="hl-0">getPaymentAddress</span><span class="hl-1">(</span><span class="hl-7">alice</span><span class="hl-1">, </span><span class="hl-10">0</span><span class="hl-1">, </span><span class="hl-2">&#39;p2pkh&#39;</span><span class="hl-1">); </span><span class="hl-3">// 141fi7TY3h936vRUKh1qfUZr8rSBuYbVBK</span><br/><br/><span class="hl-3">// check if Bob&#39;s payment code supports receiving to segwit addresses</span><br/><span class="hl-6">if</span><span class="hl-1"> (</span><span class="hl-7">bob</span><span class="hl-1">.</span><span class="hl-7">segwit</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">// Bob&#39;s P2WPKH address at index 1</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bobSegwitAddress</span><span class="hl-1"> = </span><span class="hl-7">bob</span><span class="hl-1">.</span><span class="hl-0">getPaymentAddress</span><span class="hl-1">(</span><span class="hl-7">alice</span><span class="hl-1">, </span><span class="hl-10">1</span><span class="hl-1">, </span><span class="hl-2">&#39;p2wpkh&#39;</span><span class="hl-1">); </span><span class="hl-3">// bc1qzn8a8drxv6ln7rztjsw660gzf3hnrfwupzmsfh</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p><strong>Bob&#39;s side</strong></p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-6">type</span><span class="hl-1"> {</span><span class="hl-7">PaymentCodePrivate</span><span class="hl-1">, </span><span class="hl-7">PaymentCodePublic</span><span class="hl-1">} </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@samouraiwallet/bip47&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">bobSeed</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">alicePcode</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">; </span><span class="hl-3">// base58 encoded payment code</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bob</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1"> = </span><span class="hl-7">bip47</span><span class="hl-1">.</span><span class="hl-0">fromSeed</span><span class="hl-1">(</span><span class="hl-7">bobSeed</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">alice</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1"> = </span><span class="hl-7">bip47</span><span class="hl-1">.</span><span class="hl-0">fromBase58</span><span class="hl-1">(</span><span class="hl-7">alicePcode</span><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bobAddress</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> = </span><span class="hl-7">bob</span><span class="hl-1">.</span><span class="hl-0">getPaymentAddress</span><span class="hl-1">(</span><span class="hl-7">alice</span><span class="hl-1">, </span><span class="hl-10">0</span><span class="hl-1">, </span><span class="hl-2">&#39;p2pkh&#39;</span><span class="hl-1">); </span><span class="hl-3">// 141fi7TY3h936vRUKh1qfUZr8rSBuYbVBK</span>
</code><button>Copy</button></pre>
<a id="md:derive-payment-keys-from-alice-to-bob" class="tsd-anchor"></a><h4><a href="#md:derive-payment-keys-from-alice-to-bob">Derive payment keys from Alice to Bob</a></h4><p><strong>Alice&#39;s side</strong></p>
<pre><code class="language-ts"><span class="hl-3">// Bob&#39;s payment pubkey at index 0</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bobPubKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1"> = </span><span class="hl-7">bob</span><span class="hl-1">.</span><span class="hl-0">derivePaymentPublicKey</span><span class="hl-1">(</span><span class="hl-7">alice</span><span class="hl-1">, </span><span class="hl-10">0</span><span class="hl-1">); </span><span class="hl-3">// 0344b4795e48df097bd87e6cf87a70e4f0c30b2d847b6e34cddde64af10296952d</span>
</code><button>Copy</button></pre>
<p><strong>Bob&#39;s side</strong></p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-6">type</span><span class="hl-1"> {</span><span class="hl-7">PaymentCodePrivate</span><span class="hl-1">, </span><span class="hl-7">PaymentCodePublic</span><span class="hl-1">} </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@samouraiwallet/bip47&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">bobSeed</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">alicePcode</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">; </span><span class="hl-3">// base58 encoded payment code</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bob</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1"> = </span><span class="hl-7">bip47</span><span class="hl-1">.</span><span class="hl-0">fromSeed</span><span class="hl-1">(</span><span class="hl-7">bobSeed</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">alice</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1"> = </span><span class="hl-7">bip47</span><span class="hl-1">.</span><span class="hl-0">fromBase58</span><span class="hl-1">(</span><span class="hl-7">alicePcode</span><span class="hl-1">);</span><br/><br/><span class="hl-3">// Bob&#39;s payment keys at index 0</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bobPubKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1"> = </span><span class="hl-7">bob</span><span class="hl-1">.</span><span class="hl-0">derivePaymentPublicKey</span><span class="hl-1">(</span><span class="hl-7">alice</span><span class="hl-1">, </span><span class="hl-10">0</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bobPrivKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1"> = </span><span class="hl-7">bob</span><span class="hl-1">.</span><span class="hl-0">derivePaymentPrivateKey</span><span class="hl-1">(</span><span class="hl-7">alice</span><span class="hl-1">, </span><span class="hl-10">0</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<a id="md:extract-payment-code-from-notification-transaction" class="tsd-anchor"></a><h4><a href="#md:extract-payment-code-from-notification-transaction">Extract payment code from notification transaction</a></h4><pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-6">type</span><span class="hl-1"> {</span><span class="hl-7">PaymentCodePrivate</span><span class="hl-1">, </span><span class="hl-7">PaymentCodePublic</span><span class="hl-1">} </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@samouraiwallet/bip47&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">bobSeed</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">bob</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1"> = </span><span class="hl-7">bip47</span><span class="hl-1">.</span><span class="hl-0">fromSeed</span><span class="hl-1">(</span><span class="hl-7">bob</span><span class="hl-1">.</span><span class="hl-7">seed</span><span class="hl-1">);</span><br/><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">scriptPubKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">; </span><span class="hl-3">// scriptPubKey of notification transaction OP_RETURN output</span><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">outpoint</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">; </span><span class="hl-3">// outpoint of first input of notification transaction</span><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">pubKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">; </span><span class="hl-3">// public key of first input of notification transaction</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">alice</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1"> = </span><span class="hl-7">bob</span><span class="hl-1">.</span><span class="hl-0">getPaymentCodeFromNotificationTransactionData</span><span class="hl-1">(</span><span class="hl-7">scriptPubKey</span><span class="hl-1">, </span><span class="hl-7">outpoint</span><span class="hl-1">, </span><span class="hl-7">pubKey</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">alicePcode</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> = </span><span class="hl-7">alice</span><span class="hl-1">.</span><span class="hl-0">toBase58</span><span class="hl-1">(); </span><span class="hl-3">// PM8TJTLJbPRGxSbc8EJi42Wrr6QbNSaSSVJ5Y3E4pbCYiTHUskHg13935Ubb7q8tx9GVbh2UuRnBc3WSyJHhUrw8KhprKnn9eDznYGieTzFcwQRya4GA</span>
</code><button>Copy</button></pre>
<p>In order to extract payment code from a notification transaction, the scriptPubKey, outpoint and pubKey must be provided.
You can use <code>bitcoinjs-lib</code> to extract these values from a transaction.</p>
<pre><code class="language-ts"><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-4">*</span><span class="hl-1"> </span><span class="hl-6">as</span><span class="hl-1"> </span><span class="hl-7">bitcoin</span><span class="hl-1"> </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&#39;bitcoinjs-lib&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">notificationTxHex</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">tx</span><span class="hl-1">: </span><span class="hl-9">bitcoin</span><span class="hl-1">.</span><span class="hl-9">Transaction</span><span class="hl-1"> = </span><span class="hl-7">bitcoin</span><span class="hl-1">.</span><span class="hl-7">Transaction</span><span class="hl-1">.</span><span class="hl-0">fromHex</span><span class="hl-1">(</span><span class="hl-7">notificationTxHex</span><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">opReturnOutput</span><span class="hl-1"> = </span><span class="hl-7">tx</span><span class="hl-1">.</span><span class="hl-7">outs</span><span class="hl-1">.</span><span class="hl-0">find</span><span class="hl-1">((</span><span class="hl-7">o</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><br/><span class="hl-1">    </span><span class="hl-7">o</span><span class="hl-1">.</span><span class="hl-7">script</span><span class="hl-1">[</span><span class="hl-10">0</span><span class="hl-1">] === </span><span class="hl-10">0x6a</span><span class="hl-1"> &amp;&amp; </span><span class="hl-7">o</span><span class="hl-1">.</span><span class="hl-7">script</span><span class="hl-1">[</span><span class="hl-10">1</span><span class="hl-1">] === </span><span class="hl-10">0x4c</span><span class="hl-1"> &amp;&amp; </span><span class="hl-7">o</span><span class="hl-1">.</span><span class="hl-7">script</span><span class="hl-1">[</span><span class="hl-10">2</span><span class="hl-1">] === </span><span class="hl-10">0x50</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-6">if</span><span class="hl-1"> (!</span><span class="hl-7">opReturnOutput</span><span class="hl-1">) </span><span class="hl-6">throw</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&quot;Transaction doesn&#39;t contain OP_RETURN output&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">scriptPubKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1"> = </span><span class="hl-7">opReturnOutput</span><span class="hl-1">.</span><span class="hl-7">script</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">input</span><span class="hl-1"> = </span><span class="hl-7">tx</span><span class="hl-1">.</span><span class="hl-7">ins</span><span class="hl-1">[</span><span class="hl-10">0</span><span class="hl-1">];</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">outpoint</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">Uint8Array</span><span class="hl-1">(</span><span class="hl-7">input</span><span class="hl-1">.</span><span class="hl-7">hash</span><span class="hl-1">.</span><span class="hl-7">length</span><span class="hl-1"> + </span><span class="hl-10">4</span><span class="hl-1">);</span><br/><span class="hl-7">outpoint</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-7">input</span><span class="hl-1">.</span><span class="hl-7">hash</span><span class="hl-1">);</span><br/><span class="hl-7">outpoint</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">Uint32Array</span><span class="hl-1">([</span><span class="hl-7">input</span><span class="hl-1">.</span><span class="hl-7">index</span><span class="hl-1">]), </span><span class="hl-7">input</span><span class="hl-1">.</span><span class="hl-7">hash</span><span class="hl-1">.</span><span class="hl-7">length</span><span class="hl-1">)</span><br/><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">pubKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-6">if</span><span class="hl-1"> (</span><span class="hl-7">input</span><span class="hl-1">.</span><span class="hl-7">witness</span><span class="hl-1">.</span><span class="hl-7">length</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">pubKey</span><span class="hl-1"> = </span><span class="hl-7">input</span><span class="hl-1">.</span><span class="hl-7">witness</span><span class="hl-1">[</span><span class="hl-10">1</span><span class="hl-1">];</span><br/><span class="hl-1">} </span><span class="hl-6">else</span><span class="hl-1"> </span><span class="hl-6">if</span><span class="hl-1"> (</span><span class="hl-7">bitcoin</span><span class="hl-1">.</span><span class="hl-7">script</span><span class="hl-1">.</span><span class="hl-0">toASM</span><span class="hl-1">(</span><span class="hl-7">input</span><span class="hl-1">.</span><span class="hl-7">script</span><span class="hl-1">).</span><span class="hl-0">split</span><span class="hl-1">(</span><span class="hl-2">&#39; &#39;</span><span class="hl-1">).</span><span class="hl-7">length</span><span class="hl-1"> === </span><span class="hl-10">2</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">pubKey</span><span class="hl-1"> = </span><span class="hl-7">Buffer</span><span class="hl-1">.</span><span class="hl-0">from</span><span class="hl-1">(</span><span class="hl-7">bitcoin</span><span class="hl-1">.</span><span class="hl-7">script</span><span class="hl-1">.</span><span class="hl-0">toASM</span><span class="hl-1">(</span><span class="hl-7">input</span><span class="hl-1">.</span><span class="hl-7">script</span><span class="hl-1">).</span><span class="hl-0">split</span><span class="hl-1">(</span><span class="hl-2">&#39; &#39;</span><span class="hl-1">)[</span><span class="hl-10">1</span><span class="hl-1">], </span><span class="hl-2">&#39;hex&#39;</span><span class="hl-1">,);</span><br/><span class="hl-1">} </span><span class="hl-6">else</span><span class="hl-1"> </span><span class="hl-6">throw</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&#39;Unknown Transaction type&#39;</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<a id="md:get-blinded-payment-code-for-notification-transaction" class="tsd-anchor"></a><h4><a href="#md:get-blinded-payment-code-for-notification-transaction">Get blinded payment code for notification transaction</a></h4><pre><code class="language-ts"><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">outpoint</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">; </span><span class="hl-3">// outpoint of the first input of the notification transaction</span><br/><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-7">privKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">; </span><span class="hl-3">// private key of a first input of the notification transaction</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">blindedAlicePcode</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> = </span><span class="hl-7">alicePcode</span><span class="hl-1">.</span><span class="hl-0">getBlindedPaymentCode</span><span class="hl-1">(</span><span class="hl-7">bob</span><span class="hl-1">, </span><span class="hl-7">outpoint</span><span class="hl-1">, </span><span class="hl-7">privKey</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<a id="md:interfaces" class="tsd-anchor"></a><h3><a href="#md:interfaces">Interfaces</a></h3><pre><code class="language-ts"><span class="hl-6">export</span><span class="hl-1"> </span><span class="hl-4">declare</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">BIP47Factory</span><span class="hl-1">: (</span><span class="hl-7">ecc</span><span class="hl-1">: </span><span class="hl-9">TinySecp256k1Interface</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">fromSeed</span><span class="hl-1">: (</span><span class="hl-7">bSeed</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">, </span><span class="hl-7">segwit</span><span class="hl-1">?: </span><span class="hl-9">boolean</span><span class="hl-1">, </span><span class="hl-7">network</span><span class="hl-1">?: </span><span class="hl-9">Network</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">fromBase58</span><span class="hl-1">: (</span><span class="hl-7">inString</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">, </span><span class="hl-7">network</span><span class="hl-1">?: </span><span class="hl-9">Network</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">fromBuffer</span><span class="hl-1">: (</span><span class="hl-7">buf</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">, </span><span class="hl-7">network</span><span class="hl-1">?: </span><span class="hl-9">Network</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1">;</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-6">export</span><span class="hl-1"> </span><span class="hl-4">declare</span><span class="hl-1"> </span><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">protected</span><span class="hl-1"> </span><span class="hl-4">readonly</span><span class="hl-1"> </span><span class="hl-7">ecc</span><span class="hl-1">: </span><span class="hl-9">TinySecp256k1Interface</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">protected</span><span class="hl-1"> </span><span class="hl-4">readonly</span><span class="hl-1"> </span><span class="hl-7">bip32</span><span class="hl-1">: </span><span class="hl-9">BIP32API</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">protected</span><span class="hl-1"> </span><span class="hl-4">readonly</span><span class="hl-1"> </span><span class="hl-7">buf</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">protected</span><span class="hl-1"> </span><span class="hl-4">readonly</span><span class="hl-1"> </span><span class="hl-7">network</span><span class="hl-1">: </span><span class="hl-9">Network</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-7">root</span><span class="hl-1">: </span><span class="hl-9">BIP32Interface</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-7">hasPrivKeys</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-7">segwit</span><span class="hl-1">: </span><span class="hl-9">boolean</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-4">constructor</span><span class="hl-1">(</span><span class="hl-7">ecc</span><span class="hl-1">: </span><span class="hl-9">TinySecp256k1Interface</span><span class="hl-1">, </span><span class="hl-7">bip32</span><span class="hl-1">: </span><span class="hl-9">BIP32API</span><span class="hl-1">, </span><span class="hl-7">buf</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">, </span><span class="hl-7">network</span><span class="hl-1">?: </span><span class="hl-9">Network</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-4">get</span><span class="hl-1"> </span><span class="hl-0">features</span><span class="hl-1">(): </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-4">get</span><span class="hl-1"> </span><span class="hl-0">pubKey</span><span class="hl-1">(): </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-4">get</span><span class="hl-1"> </span><span class="hl-0">chainCode</span><span class="hl-1">(): </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-4">get</span><span class="hl-1"> </span><span class="hl-0">paymentCode</span><span class="hl-1">(): </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">clone</span><span class="hl-1">(): </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">toBase58</span><span class="hl-1">(): </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">derive</span><span class="hl-1">(</span><span class="hl-7">index</span><span class="hl-1">: </span><span class="hl-9">number</span><span class="hl-1">): </span><span class="hl-9">BIP32Interface</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">getNotificationPublicKey</span><span class="hl-1">(): </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">getNotificationAddress</span><span class="hl-1">(): </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-4">protected</span><span class="hl-1"> </span><span class="hl-0">derivePublicKeyFromSharedSecret</span><span class="hl-1">(</span><span class="hl-7">B</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">, </span><span class="hl-7">S</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1"> | </span><span class="hl-9">null</span><span class="hl-1">): </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">derivePaymentPublicKey</span><span class="hl-1">(</span><span class="hl-7">paymentCode</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1">, </span><span class="hl-7">idx</span><span class="hl-1">: </span><span class="hl-9">number</span><span class="hl-1">): </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-4">protected</span><span class="hl-1"> </span><span class="hl-0">getAddressFromPubkey</span><span class="hl-1">(</span><span class="hl-7">pubKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">, </span><span class="hl-7">type</span><span class="hl-1">: </span><span class="hl-9">AddressType</span><span class="hl-1">): </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">getPaymentAddress</span><span class="hl-1">(</span><span class="hl-7">paymentCode</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1">, </span><span class="hl-7">idx</span><span class="hl-1">: </span><span class="hl-9">number</span><span class="hl-1">, </span><span class="hl-7">type</span><span class="hl-1">?: </span><span class="hl-9">AddressType</span><span class="hl-1">): </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">getBlindedPaymentCode</span><span class="hl-1">(</span><span class="hl-7">destinationPaymentCode</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1">, </span><span class="hl-7">outpoint</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">, </span><span class="hl-7">privateKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">): </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-6">export</span><span class="hl-1"> </span><span class="hl-4">declare</span><span class="hl-1"> </span><span class="hl-4">class</span><span class="hl-1"> </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1"> </span><span class="hl-4">extends</span><span class="hl-1"> </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">constructor</span><span class="hl-1">(</span><span class="hl-7">root</span><span class="hl-1">: </span><span class="hl-9">BIP32Interface</span><span class="hl-1">, </span><span class="hl-7">ecc</span><span class="hl-1">: </span><span class="hl-9">TinySecp256k1Interface</span><span class="hl-1">, </span><span class="hl-7">bip32</span><span class="hl-1">: </span><span class="hl-9">BIP32API</span><span class="hl-1">, </span><span class="hl-7">buf</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">, </span><span class="hl-7">network</span><span class="hl-1">?: </span><span class="hl-9">Network</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-0">toPaymentCodePublic</span><span class="hl-1">(): </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">clone</span><span class="hl-1">(): </span><span class="hl-9">PaymentCodePrivate</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">deriveHardened</span><span class="hl-1">(</span><span class="hl-7">index</span><span class="hl-1">: </span><span class="hl-9">number</span><span class="hl-1">): </span><span class="hl-9">BIP32Interface</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">derivePaymentPublicKey</span><span class="hl-1">(</span><span class="hl-7">paymentCode</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1">, </span><span class="hl-7">idx</span><span class="hl-1">: </span><span class="hl-9">number</span><span class="hl-1">): </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">getPaymentAddress</span><span class="hl-1">(</span><span class="hl-7">paymentCode</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1">, </span><span class="hl-7">idx</span><span class="hl-1">: </span><span class="hl-9">number</span><span class="hl-1">, </span><span class="hl-7">type</span><span class="hl-1">?: </span><span class="hl-9">AddressType</span><span class="hl-1">): </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">derivePaymentPrivateKey</span><span class="hl-1">(</span><span class="hl-7">paymentCodePublic</span><span class="hl-1">: </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1">, </span><span class="hl-7">idx</span><span class="hl-1">: </span><span class="hl-9">number</span><span class="hl-1">): </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">getNotificationPrivateKey</span><span class="hl-1">(): </span><span class="hl-9">Uint8Array</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-0">getPaymentCodeFromNotificationTransactionData</span><span class="hl-1">(</span><span class="hl-7">scriptPubKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">, </span><span class="hl-7">outpoint</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">, </span><span class="hl-7">pubKey</span><span class="hl-1">: </span><span class="hl-9">Uint8Array</span><span class="hl-1">): </span><span class="hl-9">PaymentCodePublic</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:samouraiwalletbip47"><span>@samouraiwallet/bip47</span></a><ul><li><a href="#md:contents"><span>Contents</span></a></li><li><a href="#md:installation"><span>Installation</span></a></li><li><a href="#md:api-documentation"><span>API documentation</span></a></li><li><a href="#md:usage"><span>Usage</span></a></li><li><ul><li><a href="#md:ecc-library"><span>ECC library</span></a></li><li><a href="#md:examples"><span>Examples</span></a></li><li><ul><li><a href="#md:create-an-instance-of-bip47"><span>Create an instance of bip47</span></a></li><li><a href="#md:create-a-paymetcodeprivate-instance-from-wallet-master-seed"><span>Create a <wbr/>Paymet<wbr/>Code<wbr/>Private instance from wallet master seed</span></a></li><li><a href="#md:create-a-paymetcodepublic-instance-from-payment-code-string"><span>Create a <wbr/>Paymet<wbr/>Code<wbr/>Public instance from payment code string</span></a></li><li><a href="#md:generate-a-base58-encoded-payment-code"><span>Generate a base58 encoded payment code</span></a></li><li><a href="#md:get-notification-address"><span>Get notification address</span></a></li><li><a href="#md:get-notification-address-public-key"><span>Get notification address public key</span></a></li><li><a href="#md:get-notification-address-private-key"><span>Get notification address private key</span></a></li><li><a href="#md:derive-addresses-from-alice-to-bob"><span>Derive addresses from <wbr/>Alice to <wbr/>Bob</span></a></li><li><a href="#md:derive-payment-keys-from-alice-to-bob"><span>Derive payment keys from <wbr/>Alice to <wbr/>Bob</span></a></li><li><a href="#md:extract-payment-code-from-notification-transaction"><span>Extract payment code from notification transaction</span></a></li><li><a href="#md:get-blinded-payment-code-for-notification-transaction"><span>Get blinded payment code for notification transaction</span></a></li></ul></li><li><a href="#md:interfaces"><span>Interfaces</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="index.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>@samouraiwallet/bip47</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>